<html>
<head>
    <style>

        .content {
            justify: justify;
            width: 500px;
            z-index: 1;
        }

        .highlight {
            background-color: yellow;
        }

        p {
            line-height: 50px;
            z-index: 1;
        }

    </style>

    <!-- TODO

    - ability to select text WITHIN the highlight still?
    - ability to clear the highlight
    - 

    -->


</head>

<body>

<div class="content">

    <p>

        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text <span id="myHighlight" class="highlight">that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. </span>this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.
        this is some text that is highlighted. this is some text that is highlighted.

    </p>

</div>

<script>

    // FIXME: I should probably create some code to just statically render a page
    // with various highlights and then make sure they work properly by (probably)
    // comparing the DOM before and AFTER.

    function createHighlight() {

        // FIXME use all the lighlights

        var boundingClientRect = window.getSelection().getRangeAt(0).getBoundingClientRect();

        createHighlightForRect(boundingClientRect);

    }

    function createHighlightForElement(element) {
        createHighlightForRect(element.getBoundingClientRect());
    }

    function createHighlightForRect(boundingClientRect) {

        var highlightElement = document.createElement("div");
        highlightElement.style.zIndex = "0";

        console.log("FIXME: ", boundingClientRect);

        highlightElement.style.position = "absolute";
        highlightElement.style.left = `${boundingClientRect.left}px`;
        highlightElement.style.top = `${boundingClientRect.top}px`;
        highlightElement.style.width = `${boundingClientRect.width}px`;
        highlightElement.style.height = `${boundingClientRect.height}px`;

        highlightElement.style.backgroundColor = 'yellow';
        highlightElement.style.opacity="0.3";

        // FIXME: insert this into the page element.. to the parent div... there is a
        // get common parent method that I should probably use.

        document.body.appendChild(highlightElement);

        // FIXME: now clear the selection once this is done.

        // FIXME: the highlight should/could be BELOW the text and probably should
        // be until it's deleted I think.


    }

    createHighlightForElement(document.querySelector("#myHighlight"));

</script>

</body>
</html>
