<html>
<head>
    <style>

        .content {
            width: 1020px;
        }

        .raw-highlighted-text {

        }

        body {
            line-height: 1.8em !important;
        }

        p {
        }

        .text-highlight {

            background-color: yellow;
            opacity: 0.4;
            /*cursor: pointer;*/

        }

        .text-highlight-span {
            opacity: 1.4;
        }

    </style>

    <!-- TODO

    - DONE: ability to select text WITHIN the highlight still?
    - ability to clear the highlight
    - sometimes we miss part of a sentence and it doesn't get decorated.
        - this must be a bug in text highlighter?
    - how to we factor in line-height?

    -->

    <!--

    how to highlight specific text programaticallly?

    https://stackoverflow.com/questions/11128130/select-text-in-javascript
    -->

    <!--

    Design if the text is setup like this:

    tttttttttttttttttttttthhhhhhhhhhh
    hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
    hhhhhhhhhhttttttttttttttttttttttt

    where 't' is a regular char and 'h'
    is a highlighted char and each
    line is its own div then we need to:

    1.  Break it up into spans, one per div.

    This would turn it into:

    tttttttttttttttttttttt<span class="text-highlight" id="text-highlight-101">hhhhhhhhhhh</span>
    <span class="text-highlight" id="text-highlight-101">hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh</span>
    <span class="text-highlight" id="text-highlight-101">hhhhhhhhhh</span>ttttttttttttttttttttttt

    2. this would give us 3 spans over 3 divs.

    This is necessary because pdf.js breaks the text up across rows.

    Then I need to compute three BCRs, one for each highlight, that is vertically
    adjacent to the next one, factoring in line height.

    it would look like this:

    +----------------------------+
    |                            |
    | ttttttttttttthhhhhhhhhhhhh |
    |                            |
    +============================+
    |                            |
    | hhhhhhhhhhhhhhhhhhhhhhhhhh |
    |                            |
    +----------------------------+

    This is necessary to factor in vertical line height.

    3.  Then we just draw a div within on the page at each one of the highlights.


    -->

    <script src="js/optional.js"></script>
    <script src="js/utils.js"></script>

    <script src="js/text-highlights.js"></script>
    <script src="../lib/TextHighlighter.js"></script>

</head>

<body>


    <div class="page">

        <div class="textLayer">

        </div>

    </div>

<script>


    /**
     * create fake text layers of text with positioning information.
     */
    function createFakeTextLayer() {

        var textLayer = document.querySelector(".textLayer");

        var top = 25;
        var topGap = 25;

        for(var idx = 0; idx < 200; ++idx) {

            var div = document.createElement("div");

            div.textContent = `${idx}. this is some fake text that I want to highlight.  There are many like it but this is mine.`;

            // now create the style that we need which is similar to pdf.js
            //
            // <div style="left: 643.0969333333334px; top: 182.9117666666666px; font-size: 10.6268px; font-family: monospace;">âˆ—</div>

            div.style.position="absolute";
            div.style.left="10px";
            div.style.top=`${top}px`;
            div.style.transform = 'scaleX(0.940918);';


            textLayer.appendChild(div);

            top += topGap;

        }

    }

    // FIXME: I should probably create some code to just statically render a page
    // with various highlights and then make sure they work properly by (probably)
    // comparing the DOM before and AFTER.


    //createHighlightForElement(document.querySelector("#myHighlight1"));

    createFakeTextLayer();
    TextHighlightController.create().listenForKeyBindings();

</script>

</body>
</html>
